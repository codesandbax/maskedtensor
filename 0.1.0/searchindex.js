Search.setIndex({docnames:["index","notebooks/nan_grad","notebooks/overview"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":4,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":3,"sphinx.domains.rst":2,"sphinx.domains.std":2,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":2,"sphinx.ext.viewcode":1,sphinx:56},filenames:["index.rst","notebooks/nan_grad.md","notebooks/overview.md"],objects:{},objnames:{},objtypes:{},terms:{"0":[0,2],"00":1,"0000":[1,2],"0000e":1,"0067":1,"0292":2,"03":1,"0450":2,"0498":2,"05":1,"0547":2,"0588":2,"0620":2,"0744":2,"0822":2,"1":[1,2],"10":[1,2],"100":[1,2],"11":[1,2],"1104":1,"12":[1,2],"120":2,"13":2,"14":2,"15":2,"16":2,"17":2,"18":2,"19":2,"1923":2,"1e":2,"2":[1,2],"20":2,"2078":2,"21":2,"2180":2,"22":2,"23":2,"25":2,"27":2,"28":2,"29":2,"2d":2,"3":[1,2],"30":2,"30531":1,"3120":2,"32":2,"33":2,"34":2,"3449":2,"36":2,"3725":2,"3727":2,"38":2,"3802":2,"4":[1,2],"42":2,"4274":2,"44":2,"45":2,"46":2,"475":1,"5":[1,2],"50":1,"5000":2,"5084":2,"52":2,"5338":2,"5400e":1,"5403":2,"5649":2,"57":2,"5820":2,"5909":2,"6":[1,2],"60":[1,2],"6148":2,"6239":2,"6263":2,"6324":2,"6553":2,"6667":2,"6679":2,"6681":2,"69":2,"7":2,"70":1,"7177":2,"7379e":1,"7714":2,"7877":2,"7911":2,"7935":2,"8":[1,2],"80":1,"81":2,"8287":2,"8306":2,"8314":2,"8329":2,"8462":2,"8713":2,"9":2,"90":1,"9010":2,"9015":2,"9027":2,"9210":2,"93":2,"9655":2,"9900":2,"case":[0,2],"final":2,"float":[1,2],"function":[1,2],"import":[1,2],"int":2,"new":2,"return":[1,2],"true":[1,2],"try":2,"while":2,A:1,But:2,For:2,If:[1,2],In:2,Its:1,Of:2,One:1,The:[0,1,2],__version__:[1,2],_grad:1,_indic:2,_make_spars:2,_tensor:1,_valu:2,about:2,abov:2,access:[1,2],actual:1,adagrad:2,add:[1,2],add_:2,addcdiv_:2,addcmul_:2,addit:2,advanc:2,again:2,all:2,allow:2,allreduc:2,alpha:2,alreadi:[1,2],also:2,altern:2,altogeth:2,alwai:2,amax:2,amin:2,an:[0,2],ani:[0,2],appli:2,applic:0,approach:2,ar:[1,2],arang:2,argu:2,around:[1,2],as_masked_tensor:[1,2],ask:2,associ:2,aten:1,attribut:1,autograd:[1,2],avoid:2,awar:2,b:1,back:2,backward:[1,2],base:2,becaus:2,been:2,behavior:[1,2],being:1,below:[1,2],best:2,between:[0,1,2],bgrad1:1,binari:2,block:2,bool:2,both:2,breviti:2,brittl:2,broadcast:2,bsr:2,c1:1,c:1,call:2,can:[0,1,2],care:2,caus:2,certain:2,chang:1,check:2,choos:2,clamp:1,clearli:2,clone:2,close:2,clr:2,co:2,coalesc:2,code:2,com:[1,2],comment:2,compar:2,comparison:2,completet:2,complex:2,compress:2,concern:2,conflat:2,consid:2,construct:2,contigu:2,contrast:2,conveni:2,convert:2,coo:2,core:1,could:[1,2],cours:2,cover:2,cpu:[1,2],creat:2,csr:2,cu102:[1,2],current:2,custom:2,d:2,data0:2,data1:2,data:[1,2],def:2,defin:[1,2],definit:2,dens:2,densif:2,deriv:1,detail:[0,2],develop:0,differ:[1,2],differenti:[0,1],dimension:2,discuss:2,div:[1,2],diverg:2,dodg:2,doesn:2,don:2,download:[1,2],drive:2,dtype:2,dure:[1,2],e:2,each:2,earli:0,easier:2,effect:1,element:[1,2],empti:2,empty_lik:2,encod:2,end:2,enforc:2,entir:2,env:[1,2],ep:2,equival:2,error:2,especi:0,etc:0,even:2,eventu:2,everi:2,exampl:[1,2],excel:2,except:2,exp:1,expect:1,expens:2,explicit:2,extens:[0,1,2],f:[1,2],factori:[1,2],fals:[1,2],featur:0,field:1,fill:2,fill_:2,find:2,fine:2,first:2,fix:[1,2],float32:2,fmod:2,follw:2,forc:2,format:2,found:0,from:[1,2],full_lik:2,fulli:2,further:2,gener:2,georgeqi:[1,2],get:2,github:[0,1,2],give:2,given:2,good:2,grad:[0,2],grad_fn:1,grad_indic:2,grad_valu:2,gradient:[0,1,2],h:1,ha:2,hand:2,have:2,here:[0,1,2],higher:2,home:[1,2],how:2,howev:2,html:[1,2],http:[1,2],hyperparamet:2,i:[1,2],ideal:2,illustr:2,implement:2,inabl:1,incarn:1,includ:2,inclus:2,inde:1,index:[1,2],indic:2,inf:1,inform:1,initi:2,input:2,instal:[1,2],instanc:2,instead:[1,2],intern:[1,2],intersect:2,introduc:2,invert:2,is_contigu:2,isnan:[1,2],issu:0,its:[0,1],just:2,land:2,later:2,layout:2,leaf:1,least:2,let:2,lib:[1,2],librari:0,like:2,line:2,linear:2,ll:2,logical_and:2,logical_or:2,look:[1,2],loss:1,lot:2,love:2,m0:2,m0t:2,m1:2,m1t:2,m2t:2,m:2,ma:[1,2],maintain:2,make:[1,2],manual_se:2,mask0:2,mask1:2,mask:0,masked_arrai:2,masked_data:2,masked_fil:2,masked_grad:2,masked_tensor:[1,2],maskedarrai:2,maskedtensor:1,match:2,materi:2,mean:2,memori:2,method:2,mha:2,might:2,miniconda:[1,2],minim:2,miss:2,mistak:1,modifi:2,more:[0,1,2],mt:2,mt_release_0:[1,2],much:[0,2],mul:2,multipl:2,must:2,mx:1,my:1,n:2,nan:[0,2],nanmean:2,need:2,nn:2,nnpm0:2,nnpm1:2,nnz:2,non:[1,2],none:1,note:[0,2],notic:2,now:2,np:[1,2],npm0:2,npm1:2,numel:2,numpi:[1,2],nx:2,obvious:2,off:2,onc:2,one:2,ones:1,ones_lik:1,onli:[1,2],open:2,oper:2,opportun:2,optim:2,org:[1,2],origin:2,other:2,out:[1,2],overview:0,packag:[1,2],param2:2,param:2,paramet:2,part:[0,2],particular:2,pass:2,path:2,pattern:2,pip:[1,2],place:2,pleas:[0,2],point:2,popul:1,possibl:2,pow:2,pre:[1,2],presum:2,principl:2,print:[1,2],privat:2,probabl:2,prod:2,project:0,propag:2,propos:2,proposit:2,provid:[1,2],pull:[1,2],purpos:0,py:1,pypi:[1,2],python3:[1,2],pytorch:[0,1,2],quit:2,ran:2,randint:2,randn:[1,2],re:2,realli:2,reason:2,recent:1,recycl:2,reduct:2,refer:2,regular:2,relax:2,repeat:2,request:0,requir:[1,2],requires_grad:[1,2],requires_grad_:2,reshap:2,resolut:2,resolv:0,result:[1,2],retain_grad:1,retain_graph:1,rfc:2,rigor:2,run:1,s:[1,2],same:2,satisfi:[1,2],scalar:2,scheme:2,section:2,see:[1,2],select:1,self:1,semant:0,sens:2,separ:2,serv:0,set:[1,2],setup:2,sever:1,shape:2,share:2,shorter:2,should:2,show:[1,2],similar:2,simpl:[1,2],simpler:2,sinc:2,site:[1,2],size:2,small:2,snippet:2,so:2,someon:2,spars:[0,2],sparse_coo:2,sparse_coo_tensor:2,sparse_mask:2,sparsecsr:2,sparsetensor:2,sparsiti:2,special:2,specif:[1,2],specifi:2,sqrt:2,sqrt_:2,src:1,stage:0,state:2,state_sum2:2,state_sum:2,std2:2,std:2,std_valu:2,still:2,storag:2,store:2,stride:2,subset:1,suggest:2,sum:[1,2],support:[1,2],sure:[1,2],swherebackward0:1,t:[1,2],take:2,technic:2,techniqu:2,tensor:[0,1,2],tensorbodi:1,test:[1,2],thei:2,them:[1,2],thi:[0,1,2],think:2,those:2,though:2,through:2,thu:2,time:2,to_dens:2,to_tensor:2,torch:[0,2],torch_test:[1,2],transpos:2,treat:2,trigger:1,two:2,type:[1,2],undefin:2,underli:1,uninstal:[1,2],union:2,uniqu:2,unspecifi:2,until:2,updat:2,us:[0,2],user:2,userwarn:1,v:2,valu:2,valueerror:2,vanilla:1,variat:2,variou:0,ve:2,veri:[0,2],version:2,via:2,view:2,vs:1,wa:2,want:[1,2],we:[0,1,2],welcom:0,well:2,were:2,when:2,where:[0,2],whether:2,which:[1,2],whl:[1,2],why:2,without:2,won:1,work:[1,2],would:2,write:2,written:2,x:2,y:[1,2],you:[1,2],z:2,zero:[1,2]},titles:["MaskedTensor","Resolving NaN Grad","Overview of MaskedTensors"],titleterms:{"0":1,"10729":1,"1369":2,"21987":2,"4132":1,"52248":1,"67180":1,anoth:1,basic:2,grad:1,issu:[1,2],mask:[1,2],maskedtensor:[0,2],nan:1,nanmean:1,nansum:1,overview:2,resolv:[1,2],revisit:2,semant:2,some:2,torch:1,tutori:0,us:1,when:1,where:1,x:1,yield:1}})