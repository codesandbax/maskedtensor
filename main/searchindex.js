Search.setIndex({"docnames": ["binary", "index", "install", "notebooks/issue_1369", "notebooks/nan_grad", "notebooks/nan_operators", "notebooks/overview", "notebooks/safe_softmax", "reductions", "unary", "view_and_select"], "filenames": ["binary.rst", "index.rst", "install.rst", "notebooks/issue_1369.ipynb", "notebooks/nan_grad.ipynb", "notebooks/nan_operators.ipynb", "notebooks/overview.ipynb", "notebooks/safe_softmax.ipynb", "reductions.rst", "unary.rst", "view_and_select.rst"], "titles": ["Binary Operations", "MaskedTensor", "Installation", "Efficiency of writing \u201csparse\u201d semantics for Adagrad", "Distinguishing between 0 and NaN gradient", "Implemented missing torch.nan* operators", "Overview of MaskedTensors", "Safe Softmax", "Reductions", "Unary Operations", "View and select functions"], "terms": {"As": [0, 8], "you": [0, 4, 6, 8], "mai": [0, 1], "have": [0, 3, 6], "seen": 0, "tutori": 0, "maskedtensor": [0, 2, 3, 4, 5, 7, 8, 9, 10], "also": [0, 3, 6], "ha": [0, 3, 5, 6, 7], "implement": [0, 1, 3, 6, 8, 10], "caveat": 0, "mask": [0, 1, 2, 3, 5, 7, 8, 9, 10], "two": [0, 6], "tensor": [0, 1, 2, 3, 4, 5, 6, 7, 8, 10], "must": [0, 3, 6], "match": [0, 3, 6], "els": 0, "an": [0, 1, 3, 5, 6, 7, 8], "error": [0, 3], "rais": 0, "note": [0, 1, 2], "need": [0, 3, 6], "support": [0, 3, 4, 5, 6, 8, 10], "particular": [0, 3, 6], "propos": [0, 3, 5, 8], "semant": [0, 1, 5, 8], "how": [0, 3], "thei": [0, 1, 3, 6], "should": [0, 2, 3, 6], "behav": 0, "instead": [0, 3, 4, 5, 6], "pleas": [0, 1, 6, 7, 8], "open": [0, 6], "issu": [0, 1, 3, 6, 7], "github": [0, 1, 4, 6], "For": [0, 3, 6, 7], "now": [0, 6], "we": [0, 1, 2, 3, 4, 5, 6, 9, 10], "decid": 0, "go": 0, "most": 0, "conserv": 0, "ensur": [0, 2], "user": [0, 1, 3, 5, 6], "know": 0, "exactli": 0, "what": 0, "ar": [0, 3, 4, 6, 9, 10], "being": [0, 4, 7], "intent": 0, "about": [0, 6], "decis": 0, "The": [0, 1, 3, 4, 6, 8, 9], "avail": [0, 9], "inplac": [0, 9], "all": [0, 3, 9], "abov": [0, 3, 6, 9], "except": [0, 6, 9], "alwai": [0, 3], "ani": [0, 1, 3, 6, 8], "featur": [0, 1, 7, 8], "request": [0, 1, 7, 8], "file": 0, "thi": [1, 3, 4, 5, 6, 7, 10], "librari": 1, "part": [1, 3], "pytorch": [1, 2, 3, 6, 7], "project": 1, "current": [1, 3, 8, 10], "classifi": 1, "prototyp": 1, "earli": 1, "stage": 1, "feedback": 1, "test": 1, "encourag": 1, "submit": 1, "encount": 1, "etc": 1, "can": [1, 2, 3, 4, 5, 6, 7, 10], "found": 1, "here": [1, 3, 4, 6, 8], "purpos": 1, "serv": 1, "extens": [1, 3], "torch": [1, 2, 3, 6, 7, 10], "especi": 1, "case": [1, 3, 5, 6, 7], "us": [1, 2, 3, 5, 6], "e": [1, 3, 6, 8, 10], "g": [1, 8], "variabl": 1, "length": 1, "nan": [1, 7], "oper": [1, 3, 6, 8, 10], "differenti": 1, "between": [1, 6], "0": [1, 3, 5, 6, 7, 10], "gradient": [1, 3], "variou": 1, "spars": 1, "applic": 1, "see": [1, 4, 6], "more": [1, 3, 4, 6, 7, 8], "detail": [1, 3, 7], "overview": 1, "distinguish": 1, "safe": 1, "softmax": 1, "effici": 1, "write": 1, "adagrad": 1, "miss": 1, "unari": 1, "binari": [1, 3, 6], "reduct": [1, 5], "view": [1, 6], "select": [1, 4], "function": [1, 3, 6, 7], "To": 2, "via": [2, 6], "follow": [2, 8], "command": 2, "nightli": 2, "requir": [2, 3], "1": [2, 3, 4, 5, 6, 7, 10], "11": [2, 6, 10], "work": [2, 3, 4, 6], "verifi": 2, "some": [2, 3, 5], "simpl": 2, "code": 2, "like": [2, 6, 8], "import": [2, 3, 4, 5, 6, 7], "from": [2, 3, 4, 5, 6, 7], "masked_tensor": [2, 3, 4, 5, 6, 7, 10], "data": [2, 3, 6, 7, 9, 10], "2": [2, 3, 4, 6], "3": [2, 3, 4, 6, 7, 10], "4": [2, 3, 4, 5, 6, 10], "5": [2, 3, 4, 5, 6, 10], "6": [2, 3, 4, 6, 10], "dtype": [2, 3, 6, 10], "float": [2, 3, 4, 5, 6, 7, 10], "true": [2, 4, 5, 6, 7, 10], "fals": [2, 4, 5, 6, 7, 10], "mt": [2, 6, 10], "output": [2, 8], "look": [2, 3], "0000": [2, 3, 4, 6, 7, 10], "1369": 3, "discuss": 3, "addit": [3, 5, 6], "line": 3, "were": 3, "introduc": [3, 5], "while": [3, 6], "But": [3, 6], "realli": [3, 6], "doesn": [3, 6], "t": [3, 4, 6], "sparsiti": 3, "compress": 3, "optim": 3, "techniqu": 3, "want": [3, 4, 5, 6], "around": [3, 4], "one": [3, 6, 8], "off": 3, "encod": [3, 5], "behavior": [3, 4, 6], "forc": 3, "awar": 3, "storag": 3, "indic": 3, "valu": [3, 6, 8], "let": [3, 6], "s": [3, 4], "illustr": 3, "In": [3, 6, 8, 10], "ll": [3, 6, 9], "point": [3, 5, 6], "out": [3, 4, 5, 6, 7, 9], "when": [3, 5], "i": [3, 6, 10], "unspecifi": 3, "zero": [3, 4, 6], "just": 3, "compar": 3, "contrast": 3, "equival": 3, "written": 3, "end": 3, "snippet": 3, "repeat": [3, 6], "without": 3, "comment": 3, "show": [3, 4], "differ": [3, 4, 6, 10], "breviti": 3, "as_masked_tensor": [3, 4], "def": 3, "_make_spars": 3, "grad": [3, 6], "grad_indic": 3, "size": [3, 6], "numel": 3, "return": [3, 5, 6], "empty_lik": 3, "sparse_coo_tensor": 3, "don": [3, 6], "param": 3, "arang": [3, 5, 6, 10], "8": [3, 6], "reshap": [3, 6, 10], "v": 3, "float32": 3, "state_sum": 3, "full_lik": 3, "initi": 3, "state": 3, "sum": [3, 4, 6], "print": [3, 4, 5, 6], "n": [3, 6], "to_dens": 3, "hyperparamet": 3, "ep": 3, "1e": 3, "10": [3, 4, 6], "clr": 3, "7": [3, 4, 6, 10], "5000": [3, 6], "coalesc": 3, "updat": 3, "non": [3, 4], "linear": 3, "so": 3, "uniqu": 3, "_indic": 3, "grad_valu": 3, "_valu": 3, "pow": 3, "same": 3, "both": [3, 6, 10], "dens": 3, "memori": 3, "layout": 3, "sinc": [3, 5, 6], "add_": 3, "take": 3, "care": 3, "make": [3, 4, 6], "std": 3, "even": 3, "though": 3, "clearli": 3, "mean": [3, 5, 6], "re": 3, "onli": [3, 4, 9], "appli": [3, 6, 9, 10], "which": [3, 4, 5, 7], "specifi": 3, "drive": 3, "home": 3, "lot": 3, "pass": [3, 10], "sparse_mask": 3, "9": [3, 5, 6], "16": [3, 6], "25": [3, 5], "where": 3, "veri": [3, 6], "diverg": [3, 7], "technic": 3, "enforc": 3, "certain": 3, "pattern": 3, "defin": [3, 4], "undefin": [3, 6], "If": [3, 4, 6, 8], "still": 3, "includ": [3, 10], "materi": 3, "could": [3, 4, 6], "other": [3, 5, 6, 8], "quit": 3, "brittl": 3, "someon": 3, "argu": 3, "small": 3, "scheme": 3, "caus": 3, "densif": 3, "fine": 3, "until": 3, "new": [3, 10], "csr": 3, "bsr": 3, "block": 3, "separ": 3, "type": 3, "each": 3, "variat": 3, "format": 3, "dodg": 3, "concern": 3, "privat": 3, "method": 3, "std_valu": 3, "sqrt_": 3, "div": [3, 4], "becaus": [3, 6], "well": [3, 6], "alpha": 3, "9027": 3, "9015": 3, "9010": 3, "ve": [3, 10], "been": 3, "conflat": 3, "call": 3, "through": [3, 10], "fix": [3, 4], "exampl": [3, 4, 10], "Of": 3, "cours": [3, 6], "add": [3, 4], "recycl": 3, "sparsetensor": 3, "sparsecsr": 3, "set": [3, 4, 7], "instanc": 3, "share": 3, "howev": [3, 6], "ideal": 3, "d": [3, 6], "regular": [3, 6], "those": 3, "back": 3, "masked_grad": 3, "creat": [3, 8], "entir": [3, 5, 7], "paramet": 3, "avoid": [3, 6], "param2": 3, "state_sum2": 3, "excel": 3, "why": [3, 6, 7], "to_tensor": [3, 6], "propag": 3, "maintain": [3, 6], "eventu": 3, "special": 3, "first": [3, 6], "explicit": 3, "proposit": 3, "much": 3, "simpler": 3, "complex": [3, 6], "union": 3, "intersect": [3, 6], "construct": 3, "std2": 3, "coo": 3, "version": 3, "easier": 3, "comparison": [3, 5], "0822": 3, "0620": 3, "0498": 3, "nnz": 3, "sparse_coo": 3, "place": 3, "later": [3, 6], "notic": 3, "access": [3, 4, 6], "intern": [3, 4], "gener": [3, 6, 8], "shorter": 3, "sqrt": 3, "would": [3, 5, 8], "final": 3, "result": [3, 4, 6, 7, 10], "refer": 3, "path": 3, "addcmul_": 3, "addcdiv_": 3, "origin": 3, "minim": 3, "follw": 3, "ran": 3, "again": 3, "check": [3, 6], "8329": 3, "8314": 3, "8306": 3, "numpi": 4, "np": [4, 6], "One": [4, 7], "vanilla": 4, "run": 4, "inabl": 4, "vs": 4, "actual": 4, "below": [4, 6, 10], "wai": [4, 10], "sever": 4, "fall": 4, "short": 4, "problem": 4, "underli": 4, "clamp": 4, "its": 4, "deriv": 4, "50": 4, "60": [4, 5, 6], "70": 4, "80": 4, "90": 4, "100": 4, "requires_grad": [4, 6], "y": [4, 5, 6], "exp": 4, "ones_lik": 4, "backward": [4, 6], "5400e": 4, "05": 4, "7379e": 4, "03": 4, "0000e": 4, "00": 4, "grad_fn": 4, "wherebackward0": 4, "none": 4, "tmp": 4, "ipykernel_2633": 4, "3791710618": 4, "py": 4, "userwarn": 4, "attribut": 4, "leaf": 4, "Its": 4, "won": 4, "popul": 4, "dure": [4, 6], "autograd": [4, 6], "inde": 4, "field": 4, "retain_grad": 4, "mistak": 4, "sure": [4, 6], "com": [4, 6], "pull": [4, 6], "30531": 4, "inform": 4, "trigger": 4, "aten": 4, "src": 4, "core": 4, "tensorbodi": 4, "h": 4, "477": 4, "mx": 4, "my": 4, "provid": 4, "subset": 4, "effect": 4, "chang": 4, "element": [4, 6], "them": [4, 6, 9], "0067": 4, "A": [4, 10], "recent": 4, "incarn": 4, "specif": [4, 6], "http": [4, 6], "randn": [4, 6, 7], "b": 4, "c": 4, "ones": [4, 8], "c1": 4, "bgrad1": 4, "retain_graph": 4, "ma": [4, 6], "isnan": [4, 5], "inf": [4, 7], "loss": 4, "expect": 4, "index": [4, 9], "wa": 5, "close": 5, "inclus": 5, "61474": 5, "altern": 5, "nanmean": [5, 8], "alreadi": [5, 7], "land": 5, "32": 5, "x": [5, 6, 7], "fmod": 5, "masked_fil": [5, 7], "12": [5, 6, 10], "21": [5, 6], "20": [5, 6], "33": 5, "13": [5, 6], "28": 5, "45": 5, "17": [5, 6], "36": 5, "57": 5, "44": 5, "69": 5, "52": 5, "81": 5, "29": 5, "93": 5, "6667": 5, "further": 5, "fulli": [5, 6], "given": [5, 9], "completet": 5, "hand": 5, "input": [5, 6, 8, 9], "empti": 5, "fill_": 5, "m0": 6, "m1": 6, "co": 6, "try": 6, "treat": 6, "shape": 6, "relax": 6, "good": 6, "reason": 6, "revisit": 6, "onc": 6, "valueerror": 6, "5403": 6, "9900": 6, "factori": 6, "invert": 6, "similar": 6, "nn": 6, "mha": 6, "logical_and": 6, "get": 6, "store": 6, "logical_or": 6, "suggest": 6, "section": 6, "npm0": 6, "masked_arrai": 6, "npm1": 6, "give": 6, "conveni": 6, "convert": 6, "fill": 6, "opportun": 6, "altogeth": 6, "whether": 6, "choos": 6, "presum": 6, "expens": 6, "allreduc": 6, "everi": 6, "time": 6, "m0t": 6, "m1t": 6, "m2t": 6, "2d": 6, "setup": 6, "mul": 6, "int": 6, "randint": 6, "bool": 6, "m": [6, 7], "base": 6, "rfc": [6, 8], "27": 6, "prod": 6, "min": 6, "amin": 6, "max": 6, "amax": 6, "88": 6, "140": 6, "probabl": 6, "allow": 6, "data0": 6, "data1": 6, "mask0": 6, "mask1": 6, "nnpm0": 6, "nnpm1": 6, "18": 6, "19": 6, "38": 6, "15": 6, "23": 6, "30": 6, "34": 6, "42": 6, "46": 6, "associ": 6, "least": 6, "ask": 6, "obvious": 6, "possibl": 6, "think": [6, 8], "cover": 6, "4997": 6, "9870": 6, "4005": 6, "1986": 6, "8680": 6, "5192": 6, "1787": 6, "3533": 6, "6583": 6, "9655": 6, "5663": 6, "9233": 6, "8533": 6, "2147": 6, "7839": 6, "3906": 6, "9736": 6, "8440": 6, "3738": 6, "9264": 6, "6727": 6, "2271": 6, "3955": 6, "6339": 6, "0575": 6, "4157": 6, "manual_se": 6, "22": 6, "custom": 6, "scalar": 6, "might": 6, "5084": 6, "7935": 6, "3725": 6, "2078": 6, "5820": 6, "6679": 6, "multipl": 6, "requires_grad_": 6, "broadcast": 6, "sens": 6, "consid": [6, 10], "higher": 6, "dimension": 6, "thu": 6, "love": 6, "find": [6, 7, 8], "rigor": 6, "definit": 6, "z": 6, "nx": 6, "clone": 6, "transpos": 6, "stride": 6, "masked_data": 6, "contigu": 6, "modifi": 6, "commonli": 7, "come": 7, "up": 7, "necess": 7, "batch": 7, "consist": 7, "pad": 7, "translat": 7, "lead": 7, "train": 7, "help": 7, "55056": 7, "luckili": 7, "solv": 7, "3419": 7, "6581": 7, "intro": 8, "document": 8, "reduc": 8, "dimens": 8, "singl": [8, 9], "nansum": 8, "next": 8, "op": [8, 10], "contain": 9, "rel": 9, "straightforward": 9, "moment": 9, "continu": 9, "number": 10, "under": 10, "hood": 10, "By": 10, "wrap": 10, "quick": 10, "list": 10}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"binari": 0, "oper": [0, 5, 9], "maskedtensor": [1, 6], "instal": [1, 2], "tutori": 1, "python": 1, "api": 1, "pip": 2, "verif": 2, "effici": 3, "write": 3, "spars": 3, "semant": [3, 6], "adagrad": 3, "motiv": [3, 7], "code": 3, "distinguish": 4, "between": 4, "0": 4, "nan": [4, 5], "gradient": [4, 6], "resolv": 4, "issu": [4, 5], "pytorch": 4, "10729": 4, "torch": [4, 5], "where": 4, "52248": 4, "anoth": 4, "67180": 4, "nansum": 4, "nanmean": 4, "4132": 4, "when": 4, "us": 4, "mask": [4, 6], "x": 4, "yield": 4, "grad": 4, "implement": 5, "miss": 5, "21987": 5, "overview": 6, "basic": 6, "vs": 6, "numpi": 6, "s": 6, "maskedarrai": 6, "reduct": [6, 8], "index": 6, "advanc": 6, "exampl": 6, "A": 6, "note": 6, "is_contigu": 6, "safe": 7, "softmax": 7, "unari": 9, "view": 10, "select": 10, "function": 10}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 56}})